@using EncuestasV2.Models;
@model List<encuesta_usuariosCLS>
@{
    ViewBag.Title = "DesactivarUsuarios";
    Layout = "~/Views/Shared/_Layout2.cshtml";
    List<SelectListItem> listaEmp = (List<SelectListItem>)ViewBag.listaEmpresa;
}


<div style="height:600px;overflow:auto;margin-left:10px;">
    <br />
    <h2>Desactivar Usuarios</h2>
    <hr />
    @using (Html.BeginForm("DesactivarUsuarios", "Admin", FormMethod.Post, new { @id = "frmFiltrado" }))
    {
        <a href="#" class="btn btn-danger" onclick="Desactivar()"><i class="fas fa-power-off"></i><span></span><b> Desactivar Usuarios</b></a>


        <input type="hidden" id="valorCombo" />
        <div class="table-responsive text-nowrap overflow-auto h-50 ">
            <table class="table table-striped table-sm table-hover table-bordered h-50">
                <thead>
                    <tr>
                        <th><label>Empresa:</label></th>

                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            @Html.DropDownList("usua_empresa", listaEmp, new { @class = "form-control", @id = "empresa" })
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>
        @*<label>Empresa:</label>@Html.DropDownList("usua_empresa", listaEmp, new { @class = "form-control" })*@



        <div class="table-responsive text-nowrap overflow-auto h-50 ">
            <table class="table table-striped table-sm table-hover table-bordered h-50">
                <thead>
                    <tr>
                        <th><label>Id</label></th>
                        <th><label>Nombre</label></th>
                        <th><label>Empresa</label></th>
                        <th><label>Estatus</label></th>
                        <th><label>Usuario</label></th>
                        <th><label>Genero</label></th>
                        <th><label>Edad</label></th>
                        <th><label>Estado civil</label></th>
                        <th><label>Sin formación</label></th>
                        <th><label>Primaria</label></th>
                        <th><label>Secundaria</label></th>
                        <th><label>Preparatoria</label></th>
                        <th><label>Técnico</label></th>
                        <th><label>Licenciatura</label></th>
                        <th><label>Maestría</label></th>
                        <th><label>Doctorado</label></th>
                        <th><label>Tipo Puesto</label></th>
                        <th><label>Contratación</label></th>
                        <th><label>Tipo personal</label></th>
                        <th><label>Tipo jornada</label></th>
                        <th><label>Rotación turno</label></th>
                        <th><label>Tiempo en puesto</label></th>
                        <th><label>Exp Laboral</label></th>

                    </tr>
                </thead>
                <tbody>
                    @if (Model != null)
                    {

                        foreach (var item in Model)
                        {

                            <tr>
                                <td><b>@item.usua_id</b></td>
                                <td><b>@item.usua_nombre</b></td>
                                <td><b>@item.empleado_empresa</b></td>
                                <td><b>@item.usua_estatus</b></td>
                                <td><b>@item.usua_n_usuario</b></td>
                                <td><b>@item.empleado_genero</b></td>
                                <td><b>@item.empleado_edad</b></td>
                                <td><b>@item.empleado_edocivil</b></td>
                                <td><b>@item.empleado_sinformacion</b></td>
                                <td><b>@item.empleado_primaria</b></td>
                                <td><b>@item.empleado_secundaria</b></td>
                                <td><b>@item.empleado_preparatoria</b></td>
                                <td><b>@item.empleado_tecnico</b></td>
                                <td><b>@item.empleado_licenciatura</b></td>
                                <td><b>@item.empleado_maestria</b></td>
                                <td><b>@item.empleado_doctorado</b></td>
                                <td><b>@item.empleado_tipopuesto</b></td>
                                <td><b>@item.empleado_tipocontata</b></td>
                                <td><b>@item.empleado_tipopersonal</b></td>
                                <td><b>@item.empleado_tipojornada</b></td>
                                <td><b>@item.empleado_rotacion</b></td>
                                <td><b>@item.empleado_tiempopuesto</b></td>
                                <td><b>@item.empleado_explab</b></td>

                            </tr>

                        }

                    }


                </tbody>

            </table>
        </div>
    }

    <div>
        @Html.ActionLink("Regresar al Menu", "Index", new { @class = "btn btn-primary my-2 my-sm-0" })
    </div>

</div>

<script>

    var frmFiltrado = document.getElementById("frmFiltrado");
    var valor = document.getElementById("empresa").value;
     document.getElementById("valorCombo").value = valor;
    var controles = document.getElementsByClassName("form-control");
    var ncontoles = controles.length;
    for (var i = 0; i < ncontoles; i++) {
        controles[i].onchange = function () {
            document.getElementById("valorCombo").value = valor;
            frmFiltrado.submit();
        }

    }

    function Desactivar()
    {
        var valorCombo = document.getElementById("valorCombo").value;
        //alert(valorCombo);
        if (valorCombo !=null) {
             var url = '@Html.Raw(Url.Action("Desactivar", "Admin", new { id = "_usuario_"}))';
             var params = url.replace('_usuario_', valorCombo);
            //alert(params);
            window.location.href = params;


        } else {

            window.location.href = "/Admin/DesactivarUsuarios";
        }
    }
</script>

